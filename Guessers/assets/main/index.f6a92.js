window.__require=function t(e,i,o){function n(c,s){if(!i[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var r="function"==typeof __require&&__require;if(!s&&r)return r(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var u=i[c]={exports:{}};e[c][0].call(u.exports,function(t){return n(e[c][1][t]||t)},u,u.exports,t,e,i,o)}return i[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<o.length;c++)n(o[c]);return n}({guessers:[function(t,e,i){"use strict";cc._RF.push(e,"bb0a0vHIt1KqYz+xWbHKBcL","guessers");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,o){var n,a=arguments.length,c=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(a<3?n(c):a>3?n(e,i,c):n(e,i))||c);return a>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c,s=cc._decorator,l=s.ccclass,r=s.property,u=!1;(function(t){t[t.Default=0]="Default",t[t.Select=1]="Select",t[t.Game=2]="Game",t[t.Result=3]="Result",t[t.Setting=4]="Setting",t[t.Language=5]="Language",t[t.About=6]="About"})(c||(c={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnAudio=null,e.itemAudio=null,e.finishAudio=null,e._selectNode=null,e._modelNode=null,e._languageUI=null,e._settingUI=null,e._resultUI=null,e._aboutUI=null,e._gameUI=null,e._gameTheme=null,e._themeUI=null,e._gameModel="",e._gameCount="",e._gameGuide=!1,e._shuffleResult=[],e._shuffleList=[],e._selfStepCnt=0,e._otherStepCnt=0,e._selfItemList=[],e._otherItemList=[],e._selfItemSet=new Set,e._otherItemSet=new Set,e._jsonLanguage=null,e._localVibration=1,e._localLanguage="cn",e._localSound=1,e._localTheme=1,e.updateLocalDataByKey=function(t,e){var i=JSON.parse(cc.sys.localStorage.getItem("local_data")||"{}");i[t]=e,cc.sys.localStorage.setItem("local_data",JSON.stringify(i))},e.logLine=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u&&console.log(JSON.stringify(t))},e}return n(e,t),e.prototype.onLoad=function(){this.initLocalData(),this.initNode(),this.initUI()},e.prototype.initLocalData=function(){var t=this;this._localVibration=this.getLocalDataByKey("vibration",this._localVibration),this._localLanguage=this.getLocalDataByKey("language",this._localLanguage),this._localSound=this.getLocalDataByKey("sound",this._localSound),this._localTheme=this.getLocalDataByKey("theme",this._localTheme),console.log("local >>> ",this._localLanguage,this._localSound,this._localTheme),cc.resources.load("config/language",cc.JsonAsset,function(e,i){cc.isValid(t.node)&&(t._jsonLanguage=i)})},e.prototype.initNode=function(){this._selectNode=cc.find("node_select",this.node),this._modelNode=cc.find("node_model",this.node),this._languageUI=cc.find("ui_language",this.node),this._settingUI=cc.find("ui_setting",this.node),this._resultUI=cc.find("ui_result",this.node),this._aboutUI=cc.find("ui_about",this.node),this._gameUI=cc.find("ui_game",this.node),this._gameTheme=cc.find("ui_theme/ui_game",this.node),this._themeUI=cc.find("ui_theme",this.node),cc.systemEvent.on("update_language",this.updateLanguageString,this)},e.prototype.initUI=function(t,e){switch(void 0===t&&(t=c.Default),void 0===e&&(e=!0),e&&(this._selectNode.active=!1,this._modelNode.active=!1,this._gameTheme.active=!1,this._languageUI.active=!1,this._settingUI.active=!1,this._resultUI.active=!1,this._aboutUI.active=!1,this._gameUI.active=!1),t){case c.Default:this._modelNode.active=!0;break;case c.Select:this._selectNode.active=!0;break;case c.Game:this._gameTheme.active=!0,this._gameUI.active=!0,this.initGameData();break;case c.Result:this._gameTheme.active=!0,this._resultUI.active=!0,this._gameUI.active=!0;break;case c.Setting:this.showSettingUI();break;case c.Language:this.showLanguageUI();break;case c.About:this.showAboutUI()}},e.prototype.updateThemeUI=function(){},e.prototype.showSettingUI=function(){this._settingUI.active=!0,this.updateLanguageString();var t=cc.find("layout/item_sound/ui_mark",this._settingUI),e=cc.find("layout/item_vibration/ui_mark",this._settingUI);t.active=1==this.getLocalDataByKey("sound",1),e.active=1==this.getLocalDataByKey("vibration",1)},e.prototype.clickSettingItem=function(t){if(cc.isValid(this.node))switch(this.playGameEffect(this.btnAudio),t.target.name){case"btn_close":this._settingUI.active=!1;break;case"item_sound":case"item_vibration":var e=cc.find("ui_mark",t.target);e.active=!e.active;var i=this.splitString(t.target.name,"_")[1];this.updateLocalDataByKey(i,e.active?1:0),"sound"==i&&(this._localSound=e.active?1:0),"vibration"==i&&(this._localVibration=e.active?1:0);break;case"item_language":this.initUI(c.Language,!1)}},e.prototype.showLanguageUI=function(){var t=this;this._languageUI.active=!0;var e=this.getLocalDataByKey("language","cn");cc.find("layout",this._languageUI).children.forEach(function(i){cc.find("ui_mark",i).active=t.splitString(i.name,"_")[1]==e})},e.prototype.clickLanguageItem=function(t){if(cc.isValid(this.node))switch(this.playGameEffect(this.btnAudio),t.target.name){case"btn_close":this._languageUI.active=!1,this.updateGameLanguage();break;case"item_cn":case"item_en":var e=this.splitString(t.target.name,"_");e.length&&(this._localLanguage=e[1]),t.target.parent.children.forEach(function(e){cc.find("ui_mark",e).active=e.name==t.target.name})}},e.prototype.updateGameLanguage=function(){this.getLocalDataByKey("language","cn")!=this._localLanguage&&(this.updateLocalDataByKey("language",this._localLanguage),cc.systemEvent.emit("update_language",this._localLanguage))},e.prototype.updateLanguageString=function(){cc.isValid(this.node)&&(cc.find("layout/item_language/value",this._settingUI).getComponent(cc.Label).string=this._localLanguage.toUpperCase())},e.prototype.showAboutUI=function(){this.playGameEffect(this.btnAudio),this._aboutUI.active=!0},e.prototype.clickCloseAbout=function(){this.playGameEffect(this.btnAudio),this._aboutUI.active=!1},e.prototype.initGameData=function(){this._selfStepCnt=0,this._otherStepCnt=0,this._selfItemList=[],this._otherItemList=[],this._selfItemSet.clear(),this._otherItemSet.clear();var t=this.getResultArray(Number(this._gameCount));this._shuffleResult=this.shuffleArray(t),this._shuffleList=this.shuffleArray(this._shuffleResult),this.logLine("list 111 >>> ",this._shuffleResult),this.logLine("list 222 >>> ",this._shuffleList),this._gameGuide&&(this._shuffleResult=[0,1,2],this._shuffleList=[1,2,0],this._gameModel="person");for(var e=!1,i=0;i<this._shuffleList.length;i++)this._shuffleResult[i]==this._shuffleList[i]&&(e=!0);this.logLine("list 333 >>> ",e),this.logLine("----------------------------------------------------");var o=cc.find("person",this._gameUI),n=cc.find("double",this._gameUI);switch(this._gameModel){case"person":o.active=!0,n.active=!1,this.showGameUI(this._gameUI,"person");break;case"double":o.active=!1,n.active=!0,this.showGameUI(n,"person"),this.showGameUI(n,"other")}},e.prototype.showGameUI=function(t,e){void 0===e&&(e="person");var i=cc.find("item",this._gameUI),o=cc.find(e+"/layout",t),n=cc.find(e+"/text_game_title_cnt",t),a=cc.find(e+"/text_game_finish_cnt",t),c=cc.find(e+"/text_game_step_cnt",t);if(n.getComponent(cc.Label).string=this._gameCount,a.getComponent(cc.Label).string="0",c.getComponent(cc.Label).string="0",o.destroyAllChildren(),"person"==this._gameModel){var s=cc.find(e+"/text_game_title",t),l=cc.find(e+"/ui_guide",t);s.active=n.active=!this._gameGuide,l.active=this._gameGuide}for(var r=[cc.Color.WHITE,cc.Color.GRAY,cc.Color.RED,cc.Color.GREEN,cc.Color.BLUE,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.CYAN,cc.Color.MAGENTA],h=0;h<this._shuffleList.length;h++){var g=cc.instantiate(i),f=(s=cc.find("center/text",g),cc.find("center/sprite",g));s.getComponent(cc.Label).string=this._shuffleList[h]+"",f.color=r[this._shuffleList[h]],this._shuffleList.length>=9&&(g.width=30,g.height=100,f.width=30,f.height=100),s.opacity=u?255:0,g.parent=o,g.active=!0,"person"==e?(this._selfItemList.push(g),g.on("click",this.onClickSelfItem,this)):(this._otherItemList.push(g),g.on("click",this.onClickOtherItem,this))}},e.prototype.onClickSelfItem=function(t){cc.isValid(this.node)&&(this.playGameEffect(this.itemAudio),t.node.y=t.node.y?0:20,t.node.y?this._selfItemSet.add(t.node):this._selfItemSet.delete(t.node),this.updateSelfItem())},e.prototype.updateSelfItem=function(){var t=this;if(!(this._selfItemSet.size<2)){var e=[];this._selfItemSet.forEach(function(i){t._selfItemSet.delete(i),e.push(i)});var i=cc.find("center",e[0]),o=cc.find("center",e[1]);i.parent=e[1],i.parent.y=0,o.parent=e[0],o.parent.y=0,this.updateFinishTips("person")}},e.prototype.onClickOtherItem=function(t){cc.isValid(this.node)&&(this.playGameEffect(this.itemAudio),t.node.y=t.node.y?0:20,t.node.y?this._otherItemSet.add(t.node):this._otherItemSet.delete(t.node),this.updateOtherItem())},e.prototype.updateOtherItem=function(){var t=this;if(!(this._otherItemSet.size<2)){var e=[];this._otherItemSet.forEach(function(i){t._otherItemSet.delete(i),e.push(i)});var i=cc.find("center",e[0]),o=cc.find("center",e[1]);i.parent=e[1],i.parent.y=0,o.parent=e[0],o.parent.y=0,this.updateFinishTips("other")}},e.prototype.updateFinishTips=function(t){var e=this;void 0===t&&(t="person");for(var i=0,o=[],n="person"==t?++this._selfStepCnt:++this._otherStepCnt,a="person"==t?this._selfItemList:this._otherItemList,c=0;c<a.length;c++){var s=cc.find("center/text",a[c]).getComponent(cc.Label).string;this._shuffleResult[c]==Number(s)&&i++,o.push(Number(s))}this.logLine("result >>> ",this._shuffleResult),this.logLine("update >>> ",o,i);var l="person"===this._gameModel?this._gameUI:cc.find("double",this._gameUI),r=cc.find(t+"/text_game_step_cnt",l),u=cc.find(t+"/text_game_finish_cnt",l);r.getComponent(cc.Label).string=n+"",u.getComponent(cc.Label).string=i+"",o.toString()==this._shuffleResult.toString()&&this.scheduleOnce(function(){e.showResultUI(n)},.5)},e.prototype.showResultUI=function(t){if(cc.isValid(this.node)){this.playGameEffect(this.finishAudio),this.initUI(c.Result);var e=cc.find("text_result_count",this._resultUI);if(e.getComponent(cc.Label).string=this.getLanguageString(e).replace("%s",t),"person"===this._gameModel){var i=this._gameModel+"_"+this._gameCount,o=JSON.parse(cc.sys.localStorage.getItem("local_data")||"{}"),n=(null==o?void 0:o[i])||null;(!n||this._selfStepCnt<n)&&(o[i]=this._selfStepCnt),cc.sys.localStorage.setItem("local_data",JSON.stringify(o))}}},e.prototype.getLocalDataByKey=function(t,e){var i;void 0===e&&(e=null);var o=JSON.parse(cc.sys.localStorage.getItem("local_data")||"{}");return this.logLine("local >>> ",t,o,null==o?void 0:o[t]),null!==(i=null==o?void 0:o[t])&&void 0!==i?i:e},e.prototype.isExistInArray=function(t,e){return e.some(function(e){return e==t})},e.prototype.getResultArray=function(t){for(var e=[],i=0;i<t;i++)e.push(i);return e},e.prototype.shuffleArray=function(t){for(var e=[],i=[],o=0;o<t.length;o++){var n=Math.floor(Math.random()*t.length);0==o&&0==n||this.isExistInArray(n,e)?o--:(e.push(n),i.push(t[n]))}var a=!1;for(o=0;o<t.length;o++)t[o]==i[o]&&(a=!0);return a?this.shuffleArray(t):i},e.prototype.clickModel=function(t){switch(this.playGameEffect(),this._gameModel=this.splitString(t.target.name,"_")[1],this.logLine("clickModel >>> ",this._gameModel),t.target.name){case"btn_person":case"btn_double":this._gameGuide=!1,this.initUI(c.Select);break;case"btn_guide":this._gameCount="3",this._gameGuide=!0,this.initUI(c.Game)}},e.prototype.clickSelect=function(t,e){this.logLine("clickSelect >>> ",e),this.playGameEffect(),this._gameCount=e,this.initUI(c.Game)},e.prototype.clickMainBack=function(){this.playGameEffect(),this.initUI(c.Default)},e.prototype.clickMainAbout=function(){this.playGameEffect(),this.initUI(c.About,!1)},e.prototype.clickMainSetting=function(){this.playGameEffect(),this.initUI(c.Setting,!1)},e.prototype.clickGameRestart=function(){this.playGameEffect(),this.initUI(c.Game)},e.prototype.clickGameBack=function(){this.playGameEffect(),this._gameGuide?this.initUI(c.Default):this.initUI(c.Select)},e.prototype.playGameEffect=function(t){void 0===t&&(t=this.btnAudio),1==this._localSound&&cc.audioEngine.play(t,!1,.1)},e.prototype.splitString=function(t,e){return void 0===t&&(t=""),void 0===e&&(e="."),String(t).split(e)},e.prototype.getLanguageString=function(t){var e,i;return this._localLanguage=this.getLocalDataByKey("language",this._localLanguage),(null===(i=null===(e=this._jsonLanguage.json)||void 0===e?void 0:e[t.name])||void 0===i?void 0:i[this._localLanguage])||""},e.prototype.loadRes=function(t,e,i){return void 0===e&&(e="resources"),void 0===i&&(i=cc.SpriteFrame),new Promise(function(o,n){cc.assetManager.loadBundle(e,function(e,a){a.load(t,i,function(t,e){e?o(e):n(t)})})})},e.prototype.loadResAsyc=function(t,e,i){void 0===i&&(i=null);var o=(new Date).getTime();console.log("load >>> ",o,e),cc.resources.load(e,cc.SpriteFrame,function(e,n){cc.isValid(t)&&(console.log("load time >>> ",(new Date).getTime()-o),t.getComponent(cc.Sprite).spriteFrame=n,i&&i())})},a([r(cc.AudioClip)],e.prototype,"btnAudio",void 0),a([r(cc.AudioClip)],e.prototype,"itemAudio",void 0),a([r(cc.AudioClip)],e.prototype,"finishAudio",void 0),a([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{}],languageCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"f80eauNgtRL0o6jIZceTkUW","languageCtrl");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,o){var n,a=arguments.length,c=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(a<3?n(c):a>3?n(e,i,c):n(e,i))||c);return a>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._jsonLanguage=null,e._localLanguage="cn",e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.node.opacity=0,cc.systemEvent.on("update_language",this.updateLanguageString,this),cc.resources.load("config/language",cc.JsonAsset,function(e,i){cc.isValid(t.node)&&(t._jsonLanguage=i,t.updateLanguageString())})},e.prototype.updateLanguageString=function(){if(this._jsonLanguage&&cc.isValid(this.node)){var t=this.getLanguageString(this.node);t&&(this.node.getComponent(cc.Label).string=t,this.node.opacity=255),t||console.warn("languageCtrl >>> ",this.node.name)}},e.prototype.getLanguageString=function(t){var e,i;return this._localLanguage=this.getLocalDataByKey("language",this._localLanguage),(null===(i=null===(e=this._jsonLanguage.json)||void 0===e?void 0:e[t.name])||void 0===i?void 0:i[this._localLanguage])||""},e.prototype.getLocalDataByKey=function(t,e){void 0===e&&(e=null);var i=JSON.parse(cc.sys.localStorage.getItem("local_data")||"{}");return(null==i?void 0:i[t])||e},a([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],loading:[function(t,e,i){"use strict";cc._RF.push(e,"f24e3aN5AlI64pa0Q+H6HtK","loading");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),a=this&&this.__decorate||function(t,e,i,o){var n,a=arguments.length,c=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(c=(a<3?n(c):a>3?n(e,i,c):n(e,i))||c);return a>3&&c&&Object.defineProperty(e,i,c),c};Object.defineProperty(i,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){cc.resources.preload("config/language",cc.JsonAsset,function(){cc.director.loadScene("guessers")})},a([s],e)}(cc.Component));i.default=l,cc._RF.pop()},{}]},{},["guessers","languageCtrl","loading"]);